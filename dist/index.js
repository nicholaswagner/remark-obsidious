var N=function(t){if(t==null)return K;if(typeof t=="function")return C(t);if(typeof t=="object")return Array.isArray(t)?M(t):S(t);if(typeof t=="string")return j(t);throw new Error("Expected function, string, or object as test")};function M(t){let r=[],e=-1;for(;++e<t.length;)r[e]=N(t[e]);return C(o);function o(...i){let n=-1;for(;++n<r.length;)if(r[n].apply(this,i))return!0;return!1}}function S(t){let r=t;return C(e);function e(o){let i=o,n;for(n in t)if(i[n]!==r[n])return!1;return!0}}function j(t){return C(r);function r(e){return e&&e.type===t}}function C(t){return r;function r(e,o,i){return!!(U(e)&&t.call(this,e,typeof o=="number"?o:void 0,i||void 0))}}function K(){return!0}function U(t){return t!==null&&typeof t=="object"&&"type"in t}var F=[],E=!0,v=!1,I="skip";function T(t,r,e,o){let i;typeof r=="function"&&typeof e!="function"?(o=e,e=r):i=r;let n=N(i),s=o?-1:1;c(t,void 0,[])();function c(a,d,p){let u=a&&typeof a=="object"?a:{};if(typeof u.type=="string"){let l=typeof u.tagName=="string"?u.tagName:typeof u.name=="string"?u.name:void 0;Object.defineProperty(x,"name",{value:"node ("+(a.type+(l?"<"+l+">":""))+")"})}return x;function x(){let l=F,g,f,m;if((!r||n(a,d,p[p.length-1]||void 0))&&(l=X(e(a,p)),l[0]===v))return l;if("children"in a&&a.children){let y=a;if(y.children&&l[0]!==I)for(f=(o?y.children.length:-1)+s,m=p.concat(y);f>-1&&f<y.children.length;){let b=y.children[f];if(g=c(b,f,m)(),g[0]===v)return g;f=typeof g[1]=="number"?g[1]:f+s}}return l}}}function X(t){return Array.isArray(t)?t:typeof t=="number"?[E,t]:t==null?F:[t]}function P(t,r,e,o){let i,n,s;typeof r=="function"&&typeof e!="function"?(n=void 0,s=r,i=e):(n=r,s=e,i=o),T(t,n,c,i);function c(a,d){let p=d[d.length-1],u=p?p.children.indexOf(a):void 0;return s(a,u,p)}}var A=/!?\[\[[^\]]+\]\]/g,$=/!?\[\[([^\|\]]+)(?:\s*\|\s*([^\|\]]+))?\]\]/,H=({basePath:t,classNames:r,filePathPrefix:e,getFileMetaForLabel:o,slugify:i})=>{let{linkClassName:n,imageClassName:s,errorClassName:c,embeddedMdClassName:a}=r;return(d,p,u)=>{if(!d.value||typeof d.value!="string"||!u||p===void 0||!d.value?.match(A)?.length)return;let x=[...d.value.matchAll(A)],l=[],g=0;for(let f of x){g!==f.index&&l.push({type:"text",value:d.value.slice(g,f.index)});let m=f[0].match($);if(!m){l.push({type:"text",value:f[0]}),g=f.index+f[0].length;continue}let y=m[1].indexOf("#"),b=y!==-1?m[1].slice(y):"",L=b.startsWith("^"),h=o(i(y!==-1?m[1].slice(0,y):m[1])),O=L?`${h?.label} > ${b.slice(1)}`:m[1];if(!h)console.error(h),l.push({type:"text",value:`"${m[1]}" could not be found`,data:{hName:"span",hProperties:{className:c}}});else if(m[0].startsWith("!")){let k=h.filepath;h.extension==="md"?u.data={...u.data,hName:"div",hProperties:{className:a,options:m[2]??void 0,"data-file-id":h.id,"data-hash-params":i(b)}}:l.push({type:"image",url:k,alt:O,data:{hProperties:{className:s,options:m[2]??void 0,src:e+k,"data-ext":h.extension,"data-weburl":h.webPath,"data-hash-params":i(b),"data-label":h.label}}})}else l.push({type:"link",url:t+h.webPath+b,title:O,data:{hProperties:{className:n,options:m[2]??void 0,src:e+h.filepath,"data-ext":h.extension,"data-weburl":h.webPath,"data-hash-params":i(b),"data-label":h.label}},children:[{type:"text",value:O}]});g=f.index+f[0].length}g<d.value.length&&l.push({type:"text",value:d.value.slice(g)}),typeof p=="number"&&u.children?u.children.splice(p,1,...l):u.children=l}},V=H;var R=/^\[\!\s*([\w-]+)\s*\]([-+]?)/,z=({classNames:t})=>{let{calloutClassName:r,calloutIsFoldableClassName:e,calloutTitleClassName:o}=t;return i=>{if(!Array.isArray(i.children)||i.children.length===0)return;let n=i.children.find(l=>l.type==="paragraph");if(!n||n.children.length===0)return;let s=n.children.find(l=>l.type==="text");if(!s||typeof s.value!="string"||s.value.trim()==="")return;let c=R.exec(s.value);if(!c)return;let a=c[1].toLowerCase(),d=c[2]||"",p=d!=="",u=d==="-";s.value=s.value.replace(R,"").trim();let x=s.value||a;i.data??={},i.data.hProperties={...i.data.hProperties,"data-callout":a,"data-initial-folded":String(u),"data-title":x,className:[r,p?e:""]},n.data??={},n.data.hProperties||(n.data.hProperties={}),n.data.hProperties={...n.data.hProperties,className:[o],"data-callout":a,"data-title":x}}},_=z;var W=/==([^=]+)==/gm,q=({classNames:t})=>{let{hilightClassName:r}=t;return(e,o,i)=>{if(!e.value||typeof e.value!="string"||!i||o===void 0)return;let n=[...e.value.matchAll(W)];if(n.length===0)return;let s=[],c=0;for(let a of n)c!==a.index&&s.push({type:"text",value:e.value.slice(c,a.index)}),s.push({type:"text",value:a[1],data:{hName:"span",hProperties:{className:r}}}),c=a.index+a[0].length;c<e.value.length&&s.push({type:"text",value:e.value.slice(c)}),i.children&&i.children.splice(o,1,...s)}},B=q;var w=t=>t.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9\/]+/g,"_").replace(/_+/g,"_").replace(/^_+|_+$/g,"");var D={basePath:"/",classNames:{calloutClassName:"callout",calloutIsFoldableClassName:"foldable",calloutTitleClassName:"callout-title",errorClassName:"obsidian-md-error",hilightClassName:"obsidian-hilight",imageClassName:"obsidian-img",linkClassName:"obsidian-link",embeddedMdClassName:"obsidian-md-embed "},filePathPrefix:"/vault/",slugify:w,getFileMetaForLabel:t=>null},Y=t=>{let r={...D,...t},e=V({...r}),o=_({...r}),i=B({...r});return n=>{P(n,"blockquote",o),P(n,"text",i),P(n,"text",e)}},yt=Y;export{yt as default,w as slugify};
//# sourceMappingURL=index.js.map
