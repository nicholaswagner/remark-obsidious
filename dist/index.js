var V=function(e){if(e==null)return K;if(typeof e=="function")return v(e);if(typeof e=="object")return Array.isArray(e)?M(e):_(e);if(typeof e=="string")return z(e);throw new Error("Expected function, string, or object as test")};function M(e){let t=[],i=-1;for(;++i<e.length;)t[i]=V(e[i]);return v(a);function a(...s){let r=-1;for(;++r<t.length;)if(t[r].apply(this,s))return!0;return!1}}function _(e){let t=e;return v(i);function i(a){let s=a,r;for(r in e)if(s[r]!==t[r])return!1;return!0}}function z(e){return v(t);function t(i){return i&&i.type===e}}function v(e){return t;function t(i,a,s){return!!(U(i)&&e.call(this,i,typeof a=="number"?a:void 0,s||void 0))}}function K(){return!0}function U(e){return e!==null&&typeof e=="object"&&"type"in e}var S=[],k=!0,T=!1,R="skip";function A(e,t,i,a){let s;typeof t=="function"&&typeof i!="function"?(a=i,i=t):s=t;let r=V(s),n=a?-1:1;d(e,void 0,[])();function d(o,m,g){let f=o&&typeof o=="object"?o:{};if(typeof f.type=="string"){let l=typeof f.tagName=="string"?f.tagName:typeof f.name=="string"?f.name:void 0;Object.defineProperty(O,"name",{value:"node ("+(o.type+(l?"<"+l+">":""))+")"})}return O;function O(){let l=S,b,c,u;if((!t||r(o,m,g[g.length-1]||void 0))&&(l=X(i(o,g)),l[0]===T))return l;if("children"in o&&o.children){let x=o;if(x.children&&l[0]!==R)for(c=(a?x.children.length:-1)+n,u=g.concat(x);c>-1&&c<x.children.length;){let y=x.children[c];if(b=d(y,c,u)(),b[0]===T)return b;c=typeof b[1]=="number"?b[1]:c+n}}return l}}}function X(e){return Array.isArray(e)?e:typeof e=="number"?[k,e]:e==null?S:[e]}function N(e,t,i,a){let s,r,n;typeof t=="function"&&typeof i!="function"?(r=void 0,n=t,s=i):(r=t,n=i,s=a),A(e,r,d,s);function d(o,m){let g=m[m.length-1],f=g?g.children.indexOf(o):void 0;return n(o,f,g)}}var I=e=>e.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9\/]+/g,"-").replace(/_+/g,"_").replace(/^_+|_+$/g,""),B=(e,t)=>I(t==="md"?e.replace(/\.md$/,""):e);function H(e){for(var t=0,i,a=0,s=e.length;s>=4;++a,s-=4)i=e.charCodeAt(a)&255|(e.charCodeAt(++a)&255)<<8|(e.charCodeAt(++a)&255)<<16|(e.charCodeAt(++a)&255)<<24,i=(i&65535)*1540483477+((i>>>16)*59797<<16),i^=i>>>24,t=(i&65535)*1540483477+((i>>>16)*59797<<16)^(t&65535)*1540483477+((t>>>16)*59797<<16);switch(s){case 3:t^=(e.charCodeAt(a+2)&255)<<16;case 2:t^=(e.charCodeAt(a+1)&255)<<8;case 1:t^=e.charCodeAt(a)&255,t=(t&65535)*1540483477+((t>>>16)*59797<<16)}return t^=t>>>13,t=(t&65535)*1540483477+((t>>>16)*59797<<16),((t^t>>>15)>>>0).toString(36)}var w=/!?\[\[[^\]]+\]\]/g,q=/!?\[\[([^\|\]]+)(?:\s*\|\s*([^\|\]]+))?\]\]/,Y=({basePath:e,classNames:t,filePathPrefix:i,getVaultItemByLabelSlug:a,slugify:s})=>{let{linkClassName:r,imageClassName:n,errorClassName:d,embeddedMdClassName:o}=t;return(m,g,f)=>{if(!m.value||typeof m.value!="string"||!f||g===void 0||!m.value?.match(w)?.length)return;let O=[...m.value.matchAll(w)],l=[],b=0;for(let c of O){b!==c.index&&l.push({type:"text",value:m.value.slice(b,c.index)});let u=c[0].match(q);if(!u){l.push({type:"text",value:c[0]}),b=c.index+c[0].length;continue}let x=u[1].indexOf("#"),y=x!==-1?u[1].slice(x+1):"",$=y.startsWith("^"),h=a(s(x!==-1?u[1].slice(0,x):u[1])),E=$?`${h?.label} > ${y.slice(1)}`:u[1];if(!h)console.error(h),l.push({type:"text",value:`"${u[1]}" could not be found`,data:{hName:"span",hProperties:{className:d}}});else if(u[0].startsWith("!")){let F=h.filepath;h.extension==="md"?f.data={...f.data,hName:"div",hProperties:{className:o,options:u[2]??void 0,"data-file-id":h.id,"data-hash-params":s(y)}}:l.push({type:"image",url:F,alt:E,data:{hProperties:{className:n,options:u[2]??void 0,src:i+F,"data-ext":h.extension,"data-hash-params":s(y),"data-label":h.label}}})}else{console.log("alias: ",u[2],"#: ",y);let F=y?`#${s(y)}`:"";l.push({type:"link",url:e+B(h.filepath,h.extension)+F,title:u[2]??E,data:{hProperties:{className:r,options:u[2]??void 0,src:i+h.filepath,"data-ext":h.extension,"data-hash-params":s(y),"data-label":h.label}},children:[{type:"text",value:u[2]??E}]})}b=c.index+c[0].length}b<m.value.length&&l.push({type:"text",value:m.value.slice(b)}),typeof g=="number"&&f.children?f.children.splice(g,1,...l):f.children=l}},L=Y;var D=/^\[\!\s*([\w-]+)\s*\]([-+]?)/,G=({classNames:e})=>{let{calloutClassName:t,calloutIsFoldableClassName:i,calloutTitleClassName:a}=e;return s=>{if(!Array.isArray(s.children)||s.children.length===0)return;let r=s.children.find(l=>l.type==="paragraph");if(!r||r.children.length===0)return;let n=r.children.find(l=>l.type==="text");if(!n||typeof n.value!="string"||n.value.trim()==="")return;let d=D.exec(n.value);if(!d)return;let o=d[1].toLowerCase(),m=d[2]||"",g=m!=="",f=m==="-";n.value=n.value.replace(D,"").trim();let O=n.value||o;s.data??={},s.data.hProperties={...s.data.hProperties,"data-callout":o,"data-initial-folded":String(f),"data-title":O,className:[t,g?i:""]},r.data??={},r.data.hProperties||(r.data.hProperties={}),r.data.hProperties={...r.data.hProperties,className:[a],"data-callout":o,"data-title":O}}},j=G;var J=/==([^=]+)==/gm,Q=({classNames:e})=>{let{hilightClassName:t}=e;return(i,a,s)=>{if(!i.value||typeof i.value!="string"||!s||a===void 0)return;let r=[...i.value.matchAll(J)];if(r.length===0)return;let n=[],d=0;for(let o of r)d!==o.index&&n.push({type:"text",value:i.value.slice(d,o.index)}),n.push({type:"text",value:o[1],data:{hName:"span",hProperties:{className:t}}}),d=o.index+o[0].length;d<i.value.length&&n.push({type:"text",value:i.value.slice(d)}),s.children&&s.children.splice(a,1,...n)}},W=Q;var Z=["avif","bmp","gif","jpeg","jpg","png","svg","webp"],p=null,ee=e=>(p||(p=e),P),C=e=>p&&p.files[e]||null,te=e=>p?C(p.idsByWebPath[e]):null,ie=e=>p?C(p.idsByLabelSlug[e]):null,se=()=>p?p.imageIds.map(C).filter(e=>e!==null):[],ae=()=>p?p.fileTree:[],re=e=>(p?p.idsByExtension[e]||[]:[]).map(C).filter(i=>i!==null),P={files:{},fileTree:[],idsByExtension:{},idsByLabelSlug:{},idsByWebPath:{},imageIds:[],stats:{},initialize:ee,getAllImageFiles:se,getFileForId:C,getFileForLabelSlug:ie,getFileForWebPathSlug:te,getFilesByExtension:re,getFileTree:ae,...p||{}};var oe={basePath:"/",classNames:{calloutClassName:"callout",calloutIsFoldableClassName:"foldable",calloutTitleClassName:"callout-title",errorClassName:"obsidian-md-error",hilightClassName:"obsidian-hilight",imageClassName:"obsidian-img",linkClassName:"obsidian-link",embeddedMdClassName:"obsidian-md-embed "},filePathPrefix:"/vault/",slugify:I,getVaultItemByLabelSlug:e=>P.getFileForLabelSlug(e)},ne=e=>{let t={...oe,...e},i=L({...t}),a=j({...t}),s=W({...t});return r=>{N(r,"blockquote",a),N(r,"text",s),N(r,"text",i)}},le=ne;export{P as ObsidiousVault,Z as ObsidiousVaultImageFiletypes,le as RemarkObsidious,H as hash,I as slugify,B as slugifyFilepath};
//# sourceMappingURL=index.js.map
