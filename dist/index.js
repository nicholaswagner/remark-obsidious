var V=function(e){if(e==null)return K;if(typeof e=="function")return v(e);if(typeof e=="object")return Array.isArray(e)?M(e):_(e);if(typeof e=="string")return z(e);throw new Error("Expected function, string, or object as test")};function M(e){let t=[],i=-1;for(;++i<e.length;)t[i]=V(e[i]);return v(a);function a(...s){let r=-1;for(;++r<t.length;)if(t[r].apply(this,s))return!0;return!1}}function _(e){let t=e;return v(i);function i(a){let s=a,r;for(r in e)if(s[r]!==t[r])return!1;return!0}}function z(e){return v(t);function t(i){return i&&i.type===e}}function v(e){return t;function t(i,a,s){return!!(U(i)&&e.call(this,i,typeof a=="number"?a:void 0,s||void 0))}}function K(){return!0}function U(e){return e!==null&&typeof e=="object"&&"type"in e}var S=[],k=!0,T=!1,R="skip";function A(e,t,i,a){let s;typeof t=="function"&&typeof i!="function"?(a=i,i=t):s=t;let r=V(s),o=a?-1:1;u(e,void 0,[])();function u(n,m,g){let d=n&&typeof n=="object"?n:{};if(typeof d.type=="string"){let l=typeof d.tagName=="string"?d.tagName:typeof d.name=="string"?d.name:void 0;Object.defineProperty(O,"name",{value:"node ("+(n.type+(l?"<"+l+">":""))+")"})}return O;function O(){let l=S,b,f,c;if((!t||r(n,m,g[g.length-1]||void 0))&&(l=X(i(n,g)),l[0]===T))return l;if("children"in n&&n.children){let x=n;if(x.children&&l[0]!==R)for(f=(a?x.children.length:-1)+o,c=g.concat(x);f>-1&&f<x.children.length;){let y=x.children[f];if(b=u(y,f,c)(),b[0]===T)return b;f=typeof b[1]=="number"?b[1]:f+o}}return l}}}function X(e){return Array.isArray(e)?e:typeof e=="number"?[k,e]:e==null?S:[e]}function N(e,t,i,a){let s,r,o;typeof t=="function"&&typeof i!="function"?(r=void 0,o=t,s=i):(r=t,o=i,s=a),A(e,r,u,s);function u(n,m){let g=m[m.length-1],d=g?g.children.indexOf(n):void 0;return o(n,d,g)}}var I=e=>e.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9\/]+/g,"-").replace(/_+/g,"_").replace(/^_+|_+$/g,""),B=(e,t)=>I(t==="md"?e.replace(/\.md$/,""):e);function H(e){for(var t=0,i,a=0,s=e.length;s>=4;++a,s-=4)i=e.charCodeAt(a)&255|(e.charCodeAt(++a)&255)<<8|(e.charCodeAt(++a)&255)<<16|(e.charCodeAt(++a)&255)<<24,i=(i&65535)*1540483477+((i>>>16)*59797<<16),i^=i>>>24,t=(i&65535)*1540483477+((i>>>16)*59797<<16)^(t&65535)*1540483477+((t>>>16)*59797<<16);switch(s){case 3:t^=(e.charCodeAt(a+2)&255)<<16;case 2:t^=(e.charCodeAt(a+1)&255)<<8;case 1:t^=e.charCodeAt(a)&255,t=(t&65535)*1540483477+((t>>>16)*59797<<16)}return t^=t>>>13,t=(t&65535)*1540483477+((t>>>16)*59797<<16),((t^t>>>15)>>>0).toString(36)}var w=/!?\[\[[^\]]+\]\]/g,q=/!?\[\[([^\|\]]+)(?:\s*\|\s*([^\|\]]+))?\]\]/,Y=({basePath:e,classNames:t,filePathPrefix:i,getVaultItemByLabelSlug:a,slugify:s})=>{let{linkClassName:r,imageClassName:o,errorClassName:u,embeddedMdClassName:n}=t;return(m,g,d)=>{if(!m.value||typeof m.value!="string"||!d||g===void 0||!m.value?.match(w)?.length)return;let O=[...m.value.matchAll(w)],l=[],b=0;for(let f of O){b!==f.index&&l.push({type:"text",value:m.value.slice(b,f.index)});let c=f[0].match(q);if(!c){l.push({type:"text",value:f[0]}),b=f.index+f[0].length;continue}let x=c[1].indexOf("#"),y=x!==-1?c[1].slice(x+1):"",$=y.startsWith("^"),h=a(s(x!==-1?c[1].slice(0,x):c[1])),E=$?`${h?.label} > ${y.slice(1)}`:c[1];if(!h)console.error(h),l.push({type:"text",value:`"${c[1]}" could not be found`,data:{hName:"span",hProperties:{className:u}}});else if(c[0].startsWith("!")){let F=h.filepath;h.extension==="md"?d.data={...d.data,hName:"div",hProperties:{className:n,options:c[2]??void 0,"data-file-id":h.id,"data-hash-params":s(y)}}:l.push({type:"image",url:F,alt:E,data:{hProperties:{className:o,options:c[2]??void 0,src:i+F,"data-ext":h.extension,"data-hash-params":s(y),"data-label":h.label}}})}else{let F=y?`#${s(y)}`:"";l.push({type:"link",url:e+B(h.filepath,h.extension)+F,title:c[2]??E,data:{hProperties:{className:r,options:c[2]??void 0,src:i+h.filepath,"data-ext":h.extension,"data-hash-params":s(y),"data-label":h.label}},children:[{type:"text",value:c[2]??E}]})}b=f.index+f[0].length}b<m.value.length&&l.push({type:"text",value:m.value.slice(b)}),typeof g=="number"&&d.children?d.children.splice(g,1,...l):d.children=l}},L=Y;var D=/^\[\!\s*([\w-]+)\s*\]([-+]?)/,G=({classNames:e})=>{let{calloutClassName:t,calloutIsFoldableClassName:i,calloutTitleClassName:a}=e;return s=>{if(!Array.isArray(s.children)||s.children.length===0)return;let r=s.children.find(l=>l.type==="paragraph");if(!r||r.children.length===0)return;let o=r.children.find(l=>l.type==="text");if(!o||typeof o.value!="string"||o.value.trim()==="")return;let u=D.exec(o.value);if(!u)return;let n=u[1].toLowerCase(),m=u[2]||"",g=m!=="",d=m==="-";o.value=o.value.replace(D,"").trim();let O=o.value||n;s.data??={},s.data.hProperties={...s.data.hProperties,"data-callout":n,"data-initial-folded":String(d),"data-title":O,className:[t,g?i:""]},r.data??={},r.data.hProperties||(r.data.hProperties={}),r.data.hProperties={...r.data.hProperties,className:[a],"data-callout":n,"data-title":O}}},j=G;var J=/==([^=]+)==/gm,Q=({classNames:e})=>{let{hilightClassName:t}=e;return(i,a,s)=>{if(!i.value||typeof i.value!="string"||!s||a===void 0)return;let r=[...i.value.matchAll(J)];if(r.length===0)return;let o=[],u=0;for(let n of r)u!==n.index&&o.push({type:"text",value:i.value.slice(u,n.index)}),o.push({type:"text",value:n[1],data:{hName:"span",hProperties:{className:t}}}),u=n.index+n[0].length;u<i.value.length&&o.push({type:"text",value:i.value.slice(u)}),s.children&&s.children.splice(a,1,...o)}},W=Q;var Z=["avif","bmp","gif","jpeg","jpg","png","svg","webp"],p=null,ee=e=>(p||(p=e),P),C=e=>p&&p.files[e]||null,te=e=>p?C(p.idsByWebPath[e]):null,ie=e=>p?C(p.idsByLabelSlug[e]):null,se=()=>p?p.imageIds.map(C).filter(e=>e!==null):[],ae=()=>p?p.fileTree:[],re=e=>(p?p.idsByExtension[e]||[]:[]).map(C).filter(i=>i!==null),P={files:{},fileTree:[],idsByExtension:{},idsByLabelSlug:{},idsByWebPath:{},imageIds:[],stats:{},initialize:ee,getAllImageFiles:se,getFileForId:C,getFileForLabelSlug:ie,getFileForWebPathSlug:te,getFilesByExtension:re,getFileTree:ae,...p||{}};var ne={basePath:"/",classNames:{calloutClassName:"callout",calloutIsFoldableClassName:"foldable",calloutTitleClassName:"callout-title",errorClassName:"obsidian-md-error",hilightClassName:"obsidian-hilight",imageClassName:"obsidian-img",linkClassName:"obsidian-link",embeddedMdClassName:"obsidian-md-embed "},filePathPrefix:"/vault/",slugify:I,getVaultItemByLabelSlug:e=>P.getFileForLabelSlug(e)},oe=e=>{let t={...ne,...e},i=L({...t}),a=j({...t}),s=W({...t});return r=>{N(r,"blockquote",a),N(r,"text",s),N(r,"text",i)}},le=oe;export{P as ObsidiousVault,Z as ObsidiousVaultImageFiletypes,le as RemarkObsidious,H as hash,I as slugify,B as slugifyFilepath};
//# sourceMappingURL=index.js.map
