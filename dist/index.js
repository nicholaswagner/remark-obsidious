var V=function(e){if(e==null)return U;if(typeof e=="function")return v(e);if(typeof e=="object")return Array.isArray(e)?_(e):z(e);if(typeof e=="string")return K(e);throw new Error("Expected function, string, or object as test")};function _(e){let t=[],i=-1;for(;++i<e.length;)t[i]=V(e[i]);return v(a);function a(...s){let r=-1;for(;++r<t.length;)if(t[r].apply(this,s))return!0;return!1}}function z(e){let t=e;return v(i);function i(a){let s=a,r;for(r in e)if(s[r]!==t[r])return!1;return!0}}function K(e){return v(t);function t(i){return i&&i.type===e}}function v(e){return t;function t(i,a,s){return!!(X(i)&&e.call(this,i,typeof a=="number"?a:void 0,s||void 0))}}function U(){return!0}function X(e){return e!==null&&typeof e=="object"&&"type"in e}var w=[],E=!0,k=!1,R="skip";function A(e,t,i,a){let s;typeof t=="function"&&typeof i!="function"?(a=i,i=t):s=t;let r=V(s),n=a?-1:1;u(e,void 0,[])();function u(o,m,g){let d=o&&typeof o=="object"?o:{};if(typeof d.type=="string"){let l=typeof d.tagName=="string"?d.tagName:typeof d.name=="string"?d.name:void 0;Object.defineProperty(O,"name",{value:"node ("+(o.type+(l?"<"+l+">":""))+")"})}return O;function O(){let l=w,b,c,f;if((!t||r(o,m,g[g.length-1]||void 0))&&(l=H(i(o,g)),l[0]===k))return l;if("children"in o&&o.children){let x=o;if(x.children&&l[0]!==R)for(c=(a?x.children.length:-1)+n,f=g.concat(x);c>-1&&c<x.children.length;){let y=x.children[c];if(b=u(y,c,f)(),b[0]===k)return b;c=typeof b[1]=="number"?b[1]:c+n}}return l}}}function H(e){return Array.isArray(e)?e:typeof e=="number"?[E,e]:e==null?w:[e]}function N(e,t,i,a){let s,r,n;typeof t=="function"&&typeof i!="function"?(r=void 0,n=t,s=i):(r=t,n=i,s=a),A(e,r,u,s);function u(o,m){let g=m[m.length-1],d=g?g.children.indexOf(o):void 0;return n(o,d,g)}}var P=e=>e.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9\/]+/g,"-").replace(/_+/g,"_").replace(/^_+|_+$/g,""),B=(e,t)=>P(t==="md"?e.replace(/\.md$/,""):e);function q(e){for(var t=0,i,a=0,s=e.length;s>=4;++a,s-=4)i=e.charCodeAt(a)&255|(e.charCodeAt(++a)&255)<<8|(e.charCodeAt(++a)&255)<<16|(e.charCodeAt(++a)&255)<<24,i=(i&65535)*1540483477+((i>>>16)*59797<<16),i^=i>>>24,t=(i&65535)*1540483477+((i>>>16)*59797<<16)^(t&65535)*1540483477+((t>>>16)*59797<<16);switch(s){case 3:t^=(e.charCodeAt(a+2)&255)<<16;case 2:t^=(e.charCodeAt(a+1)&255)<<8;case 1:t^=e.charCodeAt(a)&255,t=(t&65535)*1540483477+((t>>>16)*59797<<16)}return t^=t>>>13,t=(t&65535)*1540483477+((t>>>16)*59797<<16),((t^t>>>15)>>>0).toString(36)}var L=/!?\[\[[^\]]+\]\]/g,Y=/!?\[\[([^\|\]]+)(?:\s*\|\s*([^\|\]]+))?\]\]/,G=({basePath:e,classNames:t,filePathPrefix:i,getVaultItemByLabelSlug:a,slugify:s})=>{let{linkClassName:r,imageClassName:n,errorClassName:u,embeddedMdClassName:o}=t;return(m,g,d)=>{if(!m.value||typeof m.value!="string"||!d||g===void 0||!m.value?.match(L)?.length)return;let O=[...m.value.matchAll(L)],l=[],b=0;for(let c of O){b!==c.index&&l.push({type:"text",value:m.value.slice(b,c.index)});let f=c[0].match(Y);if(!f){l.push({type:"text",value:c[0]}),b=c.index+c[0].length;continue}let x=f[1].indexOf("#"),y=x!==-1?f[1].slice(x+1):"",M=y.startsWith("^"),h=a(s(x!==-1?f[1].slice(0,x):f[1])),T=M?`${h?.label} > ${y.slice(1)}`:f[1];if(!h)console.error(h),l.push({type:"text",value:`"${f[1]}" could not be found`,data:{hName:"span",hProperties:{className:u}}});else if(f[0].startsWith("!")){let F=h.filepath;h.extension==="md"?d.data={...d.data,hName:"div",hProperties:{className:o,options:f[2]??void 0,"data-file-id":h.id,"data-hash-params":s(y)}}:l.push({type:"image",url:F,alt:T,data:{hProperties:{className:n,options:f[2]??void 0,src:i+F,"data-ext":h.extension,"data-hash-params":s(y),"data-label":h.label}}})}else{let F=y?`#${s(y)}`:"";l.push({type:"link",url:e+B(h.filepath,h.extension)+F,title:f[2]??T,data:{hProperties:{className:r,options:f[2]??void 0,src:i+h.filepath,"data-ext":h.extension,"data-hash-params":s(y),"data-label":h.label}},children:[{type:"text",value:f[2]??T}]})}b=c.index+c[0].length}b<m.value.length&&l.push({type:"text",value:m.value.slice(b)}),typeof g=="number"&&d.children?d.children.splice(g,1,...l):d.children=l}},D=G;var j=/^\[\!\s*([\w-]+)\s*\]([-+]?)/,J=({classNames:e})=>{let{calloutClassName:t,calloutIsFoldableClassName:i,calloutTitleClassName:a}=e;return s=>{if(!Array.isArray(s.children)||s.children.length===0)return;let r=s.children.find(l=>l.type==="paragraph");if(!r||r.children.length===0)return;let n=r.children.find(l=>l.type==="text");if(!n||typeof n.value!="string"||n.value.trim()==="")return;let u=j.exec(n.value);if(!u)return;let o=u[1].toLowerCase(),m=u[2]||"",g=m!=="",d=m==="-";n.value=n.value.replace(j,"").trim();let O=n.value||o;s.data??={},s.data.hProperties={...s.data.hProperties,"data-callout":o,"data-initial-folded":String(d),"data-title":O,className:[t,g?i:""]},r.data??={},r.data.hProperties||(r.data.hProperties={}),r.data.hProperties={...r.data.hProperties,className:[a],"data-callout":o,"data-title":O}}},W=J;var Q=/==([^=]+)==/gm,Z=({classNames:e})=>{let{hilightClassName:t}=e;return(i,a,s)=>{if(!i.value||typeof i.value!="string"||!s||a===void 0)return;let r=[...i.value.matchAll(Q)];if(r.length===0)return;let n=[],u=0;for(let o of r)u!==o.index&&n.push({type:"text",value:i.value.slice(u,o.index)}),n.push({type:"text",value:o[1],data:{hName:"mark",hProperties:{className:t}}}),u=o.index+o[0].length;u<i.value.length&&n.push({type:"text",value:i.value.slice(u)}),s.children&&s.children.splice(a,1,...n)}},$=Z;var ee=["avif","bmp","gif","jpeg","jpg","png","svg","webp"],p=null,te=e=>(p||(p=e),I),C=e=>p&&p.files[e]||null,ie=e=>p?C(p.idsByWebPath[e]):null,se=e=>p?C(p.idsByLabelSlug[e]):null,ae=()=>p?p.imageIds.map(C).filter(e=>e!==null):[],re=()=>p?p.fileTree:[],oe=e=>(p?p.idsByExtension[e]||[]:[]).map(C).filter(i=>i!==null),I={files:{},fileTree:[],idsByExtension:{},idsByLabelSlug:{},idsByWebPath:{},imageIds:[],stats:{},initialize:te,getAllImageFiles:ae,getFileForId:C,getFileForLabelSlug:se,getFileForWebPathSlug:ie,getFilesByExtension:oe,getFileTree:re,...p||{}};var S={basePath:"/",classNames:{calloutClassName:"callout",calloutIsFoldableClassName:"foldable",calloutTitleClassName:"callout-title",errorClassName:"obsidian-md-error",hilightClassName:"obsidian-hilight",imageClassName:"obsidian-img",linkClassName:"obsidian-link",embeddedMdClassName:"obsidian-md-embed "},filePathPrefix:"/vault/",slugify:P,getVaultItemByLabelSlug:e=>I.getFileForLabelSlug(e)},ne=(e={})=>{let t={...S,...e,classNames:{...S.classNames,...e?.classNames}},i=D({...t}),a=W({...t}),s=$({...t});return r=>{N(r,"blockquote",a),N(r,"text",s),N(r,"text",i)}},le=ne;export{S as DefaultRemarkObsidiousOptions,I as ObsidiousVault,ee as ObsidiousVaultImageFiletypes,q as hash,le as remarkObsidious,P as slugify,B as slugifyFilepath};
//# sourceMappingURL=index.js.map
